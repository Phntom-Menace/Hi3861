<p>
门窗闭合检测装置
作者：<br>
-夏凡童	3215568995@qq.com<br>
-曾骞	919043258@qq.com<br>
-王振泽	3439679814@qq.com<br>

<p>
1 设计概述<br>
	1.1 设计目的<br>
		本产品聚焦于解决日常生活中“门窗闭合检测问题”。诚然，现如今智能家电如智能门窗已具备“未闭合报警功能”。但此类家电的价格相对昂贵，大部分家庭难以负担购买 。本产品在控制成本的前提下将报警功能从高度一体化的功能集中独立出来，并且将此功能与微信小程序通过 IoTDA 平台连接，使得用户可以远程查看门窗状态并且收到警报信息，能够直接解决用户外出之后无法得知家里门窗关闭状态的问题。<br>
	1.2 应用领域<br>
		本产品可应用领域极广，由于所用传感器的价格低廉，能够有效的控制成本，进而使得大部分有相关需求的家庭可以负担其价格。同时，本产品因其小巧的外形可以放置在任意门、窗之上，可以对有特殊作用的门窗进行精准的远程监管。同时通过对外壳以及传感器的更换，本产品可以适应不同温度，湿度等环境因素对监测结果的影响。同时运用不同灵敏度的传感器可以胜任从日常家居安全，酒店管理，银行金库到军械库，科研数据服务机群的门窗安保工作。<br>
	1.3 主要技术特点<br>
		在本产品（门窗闭合检测器）的主要技术特点包括：<br>
		1) IoTDA 平台：采用华为 IoTDA 技术作为核心，可以高度适配 Hi3861 芯片，实现设备管理、数据管理、组态管理和变量管理等功能，提供高效的设备信息处理和管理能力 。<br>
		2) Hi3861 终端上位机：利用 Hi3861 作为终端上位机，通过芯片自带 UART 协议接收传感器信息并进行命令分析、数据分析、错误分析和模型分析，高度利用其强大的的计算能力和灵活性。<br>
		3) LoRA 通信模块：采用自制的 LoRA 协议无线通信模块，实现 Hi3861 与传感器的低功耗通信，确保信息的高效传输和接收。<br>
		4) 微信小程序：通过微信小程序与 IoTDA 平台连接，支持多设备多用户登录、实时状态查询、实时命令下发和设备模式切换等功能，能够使用户远程与 Hi3861 通信。<br>
		5) SMPP 短信通知：利用 SMPP 协议将警报以短信方式通知用户，确保实时的安全警报传递和响应。<br>
1.4 关键性能指标:<br>
		1) 响应时间：本产品从接收指令到执行相应操作的时间极短。快速响应可以提供实时的监测和控制能力。<br>
		2) 覆盖范围：本产品传感器和 Hi3861 芯片的稳定无线通信可以满足目前市面上所有家居住房范围，在遮挡物较分散的情况下可以满足 500 米内的稳定通信。超广的覆盖范围能够保证本产品广泛的应用领域。<br>
		3) 准确性：指产品对门窗闭合状态和雨水情况的检测准确程度。较高的准确性可以提高产品的可靠性和实用性。<br>
		4) 通信稳定性：指产品与 Hi3861 终端、微信小程序、手机以及传感器之间通信的稳定性。稳定的通信能够确保信息的准确传递和操作的顺利执行。<br>
		5) 能耗效率：指产品在正常运行状态下的能耗水平。对于一个闭合检测器，较低的能耗可以延长电池寿命或减少能源消耗。<br>
1.5 主要创新点:<br>
		1) 使用锡箔纸触发片替代传统的门磁感应开关：本产品使用的锡箔纸触发片不仅成本低，而且更易于替换，大大提高了产品的便利性、适用范围与重复利用率。<br>
		2) 独立的分布式设备设计：相较于市面上的一体化的智能家居系统，此产品能分布在不同的家居如门、窗，更利于降低成本，提高装置的灵活性和可用性。<br>
		3) 采用 IoTDA 技术作为核心以实现高效的设备信息处理和管理。通过小程序与 IoTDA 平台连接，支持多设备多用户登录、实时状态查询、实时命令下发和设备模式切换等功能。这是市面上大多数门窗检测系统所不能达成的，这为用户提供了更方便、实时的监控方式。<br>
		4) LoRA 通信模块：本产品采用 LoRA 通信模块，实现了 Hi3861 与传感器的低功耗通信，保证了信息的高效传输与接收，相较于传统的通信模块，LoRA 通信模块具有更低的功耗与更广的覆盖范围。<br>
</p>
2 系统组成及功能说明<br>
	2.1 整体介绍<br>
	门窗闭合检测装置<br>
	本产品（门窗闭合检测器）包含六个模块：Hi3861 芯片、传感器、IoTDA 平台、微信小程序、手机和 LoRA 模块（如图 1显示）。其中以 Hi3861 终端为核心，并联 IoTDA 平台、微信小程序和手机短信。IoTDA 通过 TCP 协议、MQTT 协议与 Hi3861 建立通信链路，信息收集后进行设备管理、数据管理、组态管理和变量管理，根据不同的上传数据进行消息存储、命令转发、实时控制和状态查询 [3]。使用 Hi3861 作为终端上位机接收传感器信息，对信息进行命令分析、错误分析、数据分析、模型分析 [4]。在此基础上，结合 IoTDA 平台下发的命令，进行警告转发、命令转发，从而实现实时控制与状态查询的功能 [3]。Hi3861 通过自制 LoRA 协议通信模块与传感器进行通信。该通信模块使用较低功耗、较低算力单片机实现 UART 协议的信息交换 [5]。传感器方面，通过识别上位机发送的命令识别、转换设备工作模式。设备工作模式主要包含监测模式和告警模式。将检测门窗闭合情况和雨水传感器的信息进行信息上报或者告警。微信小程序方面，通过移动网络或者WiFi 与 IoTDA 平台连接，支持多设备多用户登录、实时状态查询、实时命令下发和设备模式切换。微信小程序通过WebSocket 可以与手机通信。除此之外，IoTDA 平台通过 SMPP 协议，将警报以短信方式通知用户。<br>
	2.2 各模块介绍<br>
		1) Hi3861 端：作为上位机，通过 LoRA 通信与 UART 协议接受传感器信息并进行命令分析、数据分析、错误分析与模型分析。Hi3861 通过 MQTT 协议连接 IoTDA 平台，并实时上报从传感器端上传的数据或向传感器端下发从云平台接收的命令。<br>
		2) 传感器端：收集外界的实时信息，做到远程监管门窗闭合情况和雨水传感器的状态。通过识别上位机下发的命令转换自身工作模式，将门窗实时信息上报或发布告警。<br>
		3) IoTDA 端：通过 TCP 协议及 MQTT 协议与 Hi3861 建立通信链路，收集信息上传至云端日志。与此同时，将信息转发至微信小程序端，再通过接口处匹配后将相应状态展示在微信小程序内。IoTDA 端在进行信息收集后可以运行设备管理、数据管理、组态管理和变量管理等功能，根据上传的不同数据进行消息存储、命令转发、实时控制和状态查询等机制。<br>
		4) 微信小程序端：通过移动网络或 WiFi 与 IoTDA 平台连接，支持多设备多用户登录、实时状态查询、实时命令下发和设备模式切换。<br>
		5) LoRA 模块：模块内置单片机，通过 UART 通信处理信息，并通过 LoRA 无线通信实现与Hi3861 的远距离低功耗通信。<br>
